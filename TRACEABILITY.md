# Traceability

| Issue ID | Files Touched | Tests Added | Endpoints | Notes |
| --- | --- | --- | --- | --- |
| A1-DB-01 (#15) | `database/migrations/2024_01_01_000140_create_tickets_table.php`, `app/Modules/Helpdesk/Models/Ticket.php`, `app/Models/Concerns/BelongsToTenant.php`, `app/Support/Tenancy/TenantContext.php`, `app/Http/Middleware/ResolveTenantContext.php`, `bootstrap/app.php`, `config/tenancy.php` | `tests/Feature/TicketSchemaTest.php` (@group A1-DB-01) | N/A | Introduced SLA columns, tenant scope wiring, and context middleware. |
| A1-DB-02 (#16) | `database/migrations/2024_01_01_000210_create_ticket_categories_table.php`, `...000220_create_ticket_tags_table.php`, `...000230_create_ticket_category_ticket_table.php`, `...000240_create_ticket_tag_ticket_table.php`, `app/Modules/Helpdesk/Models/TicketCategory.php`, `app/Modules/Helpdesk/Models/TicketTag.php`, `database/factories/TicketCategoryFactory.php`, `database/factories/TicketTagFactory.php`, `database/seeders/DemoDataSeeder.php` | `tests/Feature/TicketTaxonomyTest.php` (@group A1-DB-02) | N/A | Added taxonomy storage and guarded pivot syncing for tenant-safe metadata. |
| A1-MD-01 (#17) | `app/Modules/Helpdesk/Models/Ticket.php`, `app/Modules/Helpdesk/Events/TicketStatusChanged.php`, `app/Modules/Helpdesk/Observers/TicketObserver.php`, `app/Http/Controllers/Api/TicketController.php`, `app/Http/Requests/StoreTicketRequest.php`, `app/Http/Requests/UpdateTicketRequest.php`, `app/Http/Resources/*`, `routes/api.php`, `app/Modules/Helpdesk/Filament/Resources/TicketResource*.php`, `app/Policies/TicketPolicy.php`, `tests/Feature/TicketApiAndFilamentTest.php`, `tests/Feature/PolicyAccessTest.php`, `OPENAPI.yaml`, `README.md`, `CHANGELOG.md`, `TRACEABILITY.md` | `tests/Feature/TicketApiAndFilamentTest.php` (@group A1-MD-01), `tests/Feature/PolicyAccessTest.php` (@group A1-MD-01) | `GET/POST/PUT/DELETE /api/tickets` | Implemented scoped Ticket model behaviors, API + Filament flows, auditing observer, and documentation. |
| A1-SD-01 (#18) | `database/migrations/2024_01_01_000250_create_ticket_statuses_table.php`, `...000260_create_ticket_priorities_table.php`, `...000270_create_ticket_workflow_transitions_table.php`, `app/Modules/Helpdesk/Models/TicketStatus.php`, `app/Modules/Helpdesk/Models/TicketPriority.php`, `app/Modules/Helpdesk/Models/TicketWorkflowTransition.php`, `database/factories/TicketStatusFactory.php`, `database/factories/TicketPriorityFactory.php`, `database/factories/TicketWorkflowTransitionFactory.php`, `database/seeders/TicketLifecycleSeeder.php`, `database/seeders/DemoDataSeeder.php`, `routes/console.php`, `config/ticketing.php`, `tests/Feature/TicketLifecycleSeederTest.php`, `README.md`, `OPENAPI.yaml`, `CHANGELOG.md`, `TRACEABILITY.md` | `tests/Feature/TicketLifecycleSeederTest.php` (@group A1-SD-01) | `POST /api/tickets` (defaults via seeding) | Added tenant-scoped lifecycle defaults with artisan reseeding command and documentation. |
| A1-OB-01 (#19) | `app/Modules/Helpdesk/Models/Ticket.php`, `app/Modules/Helpdesk/Services/TicketSlaEvaluator.php`, `app/Modules/Helpdesk/Events/TicketSlaBreached.php`, `app/Modules/Helpdesk/Events/TicketSlaRecovered.php`, `app/Modules/Helpdesk/Observers/TicketSlaObserver.php`, `app/Modules/Helpdesk/Observers/TicketObserver.php`, `app/Providers/AppServiceProvider.php`, `app/Http/Resources/TicketResource.php`, `tests/Feature/TicketSlaObserverTest.php`, `OPENAPI.yaml`, `README.md`, `CHANGELOG.md` | `tests/Feature/TicketSlaObserverTest.php` (@group A1-OB-01) | `GET/PUT /api/tickets` (SLA metadata) | Implemented SLA evaluation, breach/recovery events, sanitized audit logging, and exposed SLA snapshots in the API. |
| A1-TS-01 (#21) | `app/Http/Controllers/Api/TicketController.php`, `app/Http/Requests/StoreTicketRequest.php`, `app/Http/Requests/UpdateTicketRequest.php`, `app/Modules/Helpdesk/Filament/Resources/TicketResource.php`, `tests/Feature/TicketTenantIsolationTest.php`, `tests/Feature/TicketApiAndFilamentTest.php`, `README.md`, `OPENAPI.yaml`, `CHANGELOG.md` | `tests/Feature/TicketTenantIsolationTest.php` (@group A1-TS-01), `tests/Feature/TicketApiAndFilamentTest.php` (@group A1-MD-01) | `GET/POST/PUT /api/tickets` | Enforced tenant/brand scoping on ticket mutations and added isolation coverage across API and Filament. |
| A2-DB-01 (#23) | `database/migrations/2024_01_01_000310_create_ticket_messages_table.php`, `database/migrations/2024_01_01_000320_create_ticket_participants_table.php`, `app/Modules/Helpdesk/Models/TicketMessage.php`, `app/Modules/Helpdesk/Models/TicketParticipant.php`, `database/factories/TicketMessageFactory.php`, `database/factories/TicketParticipantFactory.php` | `tests/Feature/TicketMessageSchemaTest.php` (@group A2-DB-01) | N/A (schema foundations) | Added tenant/brand scoped collaboration tables with dedupe hashes, indexes, and factories. |
| A2-MD-01 (#24) | `app/Http/Controllers/Api/TicketMessageController.php`, `app/Http/Requests/StoreTicketMessageRequest.php`, `app/Http/Resources/TicketMessageResource.php`, `app/Http/Resources/AttachmentResource.php`, `app/Modules/Helpdesk/Services/TicketMessageService.php`, `app/Modules/Helpdesk/Models/Ticket.php`, `routes/api.php`, `app/Modules/Helpdesk/Filament/Resources/TicketMessageResource.php`, `app/Modules/Helpdesk/Filament/Resources/TicketMessageResource/Pages/*`, `app/Policies/TicketMessagePolicy.php`, `app/Providers/AuthServiceProvider.php`, `tests/Feature/TicketMessageApiAndFilamentTest.php`, `tests/Feature/TicketMessagePolicyTest.php`, `README.md`, `OPENAPI.yaml`, `database/seeders/DemoDataSeeder.php`, `database/seeders/RoleSeeder.php` | `tests/Feature/TicketMessageApiAndFilamentTest.php` (@group A2-MD-01), `tests/Feature/TicketMessagePolicyTest.php` (@group A2-MD-01) | `GET/POST /api/tickets/{ticket}/messages` | Implemented tenant-scoped message append pipeline with RBAC, participants, attachments, Filament UI, docs, and seeded demo data. |
| A2-OB-01 (#26) | `app/Modules/Helpdesk/Services/AttachmentScanner.php`, `app/Modules/Helpdesk/Observers/TicketMessageObserver.php`, `app/Modules/Helpdesk/Services/TicketMessageService.php`, `app/Providers/AppServiceProvider.php`, `CHANGELOG.md` | `tests/Feature/TicketMessageApiAndFilamentTest.php` (@group A2-MD-01) | `POST /api/tickets/{ticket}/messages` (audit + scanning) | Hooked message observers for audit trails and attachment scanning logs to guard collaboration hygiene. |
| #10 | `database/migrations/2024_01_02_000420_add_theme_fields_to_brands_table.php`, `app/Modules/Helpdesk/Models/Brand.php`, `app/Modules/Helpdesk/Filament/Resources/BrandResource.php` (+ pages), `app/Http/Controllers/Portal/*`, `app/Http/Middleware/SetBrandFromRoute.php`, `app/Http/Requests/Portal/SubmitTicketRequest.php`, `routes/web.php`, `resources/views/portal/*`, `database/factories/BrandFactory.php`, `database/seeders/TenantSeeder.php`, `database/seeders/DemoDataSeeder.php`, `README.md`, `CHANGELOG.md` | `tests/Feature/PortalExperienceTest.php` (@group Issue-10) | `GET /portal/{brand}`, `GET/POST /portal/{brand}/tickets` | Introduced branded customer portal with knowledge base browse, ticket submission, and Filament brand theming controls bound to tenant scope. |
| #11 | `database/migrations/2024_01_02_000410_add_security_fields_to_users_table.php`, `app/Models/User.php`, `app/Support/Security/TotpService.php`, `app/Support/Security/SecurityEventLogger.php`, `app/Http/Controllers/Api/TwoFactorController.php`, `app/Http/Requests/ConfirmTwoFactorRequest.php`, `app/Http/Requests/UpdateIpRestrictionRequest.php`, `app/Http/Middleware/EnforceUserIpRestrictions.php`, `app/Policies/UserSecurityPolicy.php`, `app/Providers/AuthServiceProvider.php`, `bootstrap/app.php`, `routes/api.php`, `README.md`, `CHANGELOG.md` | `tests/Feature/SecurityTwoFactorTest.php` (@group Issue-11), `tests/Feature/UserSecurityPolicyTest.php` (@group Issue-11) | `POST/DELETE /api/security/two-factor`, `POST /api/security/two-factor/confirm`, `PATCH /api/security/ip-restrictions` | Added TOTP enrollment with recovery codes, policy-governed IP allow/block lists, and audit logging for security actions. |
| #12 | `database/migrations/2024_01_02_000400_create_monitoring_tokens_table.php`, `app/Models/MonitoringToken.php`, `database/factories/MonitoringTokenFactory.php`, `database/seeders/MonitoringTokenSeeder.php`, `database/seeders/DatabaseSeeder.php`, `config/monitoring.php`, `config/logging.php`, `app/Support/Health/HealthReporter.php`, `app/Http/Controllers/Api/HealthStatusController.php`, `app/Http/Controllers/HealthcheckController.php`, `routes/api.php`, `.env.example`, `README.md`, `OPENAPI.yaml`, `CHANGELOG.md` | `tests/Feature/HealthEndpointTest.php` (@group Issue-12) | `GET /api/health` | Delivered monitoring tokens with structured logging and a dependency health endpoint guarded by header/IP checks. |
| A2-RB-01 (#27) | `app/Modules/Helpdesk/Models/TicketMessage.php`, `app/Modules/Helpdesk/Services/TicketMessageService.php`, `app/Policies/TicketMessagePolicy.php`, `app/Http/Controllers/Api/TicketMessageController.php`, `app/Modules/Helpdesk/Filament/Resources/TicketMessageResource.php` | `tests/Feature/TicketMessagePolicyTest.php` (@group A2-RB-01), `tests/Feature/TicketMessageApiAndFilamentTest.php` (@group A2-RB-01) | `GET /api/tickets/{ticket}/messages` | Enforced private note RBAC, scoped viewer visibility, and sanitised participant updates for internal notes. |
| A2-TS-01 (#28) | `app/Http/Controllers/Api/ChannelIngestionController.php`, `app/Http/Controllers/Api/TicketBulkActionController.php`, `app/Http/Requests/IngestTicketMessageRequest.php`, `app/Http/Requests/PerformTicketBulkActionRequest.php`, `app/Jobs/ProcessTicketBulkAction.php`, `app/Modules/Helpdesk/Services/TicketBulkActionService.php`, `app/Modules/Helpdesk/Filament/Resources/TicketResource.php`, `routes/api.php`, `config/services.php` | `tests/Feature/TicketChannelIngestionTest.php` (@group A2-TS-01), `tests/Feature/TicketBulkActionApiTest.php` (@group A2-TS-01), `tests/Feature/TicketBulkActionFilamentTest.php` (@group A2-TS-01) | `POST /api/tickets/{ticket}/ingest`, `POST /api/tickets/bulk-actions` | Added channel ingestion with secret validation plus reusable bulk action pipeline shared by API and Filament bulk tools. |
| A2-DC-01 (#29) | `docs/collaboration-flows.md`, `README.md`, `OPENAPI.yaml`, `CHANGELOG.md`, `.env.example` | N/A | Documentation | Documented collaboration flows, adapter responsibilities, and surfaced the new ingestion secret in env/docs. |
| A1-RB-01 (#20) | `app/Policies/TicketPolicy.php`, `app/Modules/Helpdesk/Models/Ticket.php`, `app/Http/Controllers/Api/TicketController.php`, `app/Http/Requests/StoreTicketRequest.php`, `app/Http/Requests/UpdateTicketRequest.php`, `app/Http/Resources/TicketResource.php`, `database/seeders/RoleSeeder.php`, `tests/Feature/TicketWatcherApiTest.php`, `tests/Feature/PolicyAccessTest.php`, `OPENAPI.yaml`, `README.md`, `CHANGELOG.md` | `tests/Feature/TicketWatcherApiTest.php` (@group A1-RB-01), `tests/Feature/PolicyAccessTest.php` (@group A1-MD-01) | `PUT /api/tickets/{ticket}` (assignment + watchers) | Added watcher-aware ticket policy methods, scoped watcher sync with audit logging, and documented `watcher_ids` support. |
| A1-DC-01 (#22) | `docs/adr/2024-06-12-ticket-schema-and-tenancy.md`, `README.md`, `OPENAPI.yaml`, `CHANGELOG.md`, `TRACEABILITY.md` | N/A | Documentation | Captured ticket schema & tenancy ADR covering ERD, watcher strategy, and seeding/runbook guidance. |
| A2-SD-01 (#25) | `database/migrations/2024_01_03_000500_create_channel_adapters_table.php`, `database/migrations/2024_01_03_000510_create_ticket_macros_table.php`, `app/Modules/Helpdesk/Models/ChannelAdapter.php`, `app/Modules/Helpdesk/Models/TicketMacro.php`, `database/factories/ChannelAdapterFactory.php`, `database/factories/TicketMacroFactory.php`, `app/Policies/ChannelAdapterPolicy.php`, `app/Policies/TicketMacroPolicy.php`, `app/Providers/AuthServiceProvider.php`, `app/Http/Controllers/Api/ChannelAdapterController.php`, `app/Http/Controllers/Api/TicketMacroController.php`, `app/Http/Requests/StoreChannelAdapterRequest.php`, `app/Http/Requests/UpdateChannelAdapterRequest.php`, `app/Http/Requests/StoreTicketMacroRequest.php`, `app/Http/Requests/UpdateTicketMacroRequest.php`, `app/Http/Resources/ChannelAdapterResource.php`, `app/Http/Resources/TicketMacroResource.php`, `app/Modules/Helpdesk/Filament/Resources/ChannelAdapterResource.php` (+ pages), `app/Modules/Helpdesk/Filament/Resources/TicketMacroResource.php` (+ pages), `routes/api.php`, `database/seeders/ChannelAdapterMacroSeeder.php`, `database/seeders/DatabaseSeeder.php`, `tests/Feature/ChannelAdapterApiTest.php`, `tests/Feature/TicketMacroApiTest.php`, `OPENAPI.yaml`, `README.md`, `CHANGELOG.md` | `tests/Feature/ChannelAdapterApiTest.php` (@group A2-SD-01), `tests/Feature/TicketMacroApiTest.php` (@group A2-SD-01) | `GET/POST/PUT/DELETE /api/channel-adapters`, `GET/POST/PUT/DELETE /api/ticket-macros` | Seeded baseline channel connectors/macros, exposed RBAC-guarded APIs + Filament resources, and documented tenancy-aware configuration. |
| TKT-EMAIL-DB-01 (#116) | `database/migrations/2024_01_04_000600_create_email_mailboxes_table.php`, `...000610_create_email_inbound_messages_table.php`, `...000620_create_email_outbound_messages_table.php`, `...000630_create_email_attachments_table.php`, `app/Modules/Helpdesk/Models/EmailMailbox.php`, `app/Modules/Helpdesk/Models/EmailInboundMessage.php`, `app/Modules/Helpdesk/Models/EmailOutboundMessage.php`, `app/Modules/Helpdesk/Models/EmailAttachment.php`, `database/factories/EmailMailboxFactory.php`, `database/factories/EmailInboundMessageFactory.php`, `database/factories/EmailOutboundMessageFactory.php`, `database/factories/EmailAttachmentFactory.php` | `tests/Feature/EmailPipelineSchemaTest.php` (@group TKT-EMAIL-DB-01) | N/A | Established tenant/brand scoped email storage with encrypted credentials and attachment linkage. |
| TKT-EMAIL-MD-02 (#117) | `app/Modules/Helpdesk/Services/Email/*`, `app/Http/Controllers/Api/EmailMailboxController.php`, `app/Http/Controllers/Api/EmailInboundMessageController.php`, `app/Http/Controllers/Api/EmailOutboundMessageController.php`, `app/Http/Resources/EmailMailboxResource.php`, `app/Http/Resources/EmailInboundMessageResource.php`, `app/Http/Resources/EmailOutboundMessageResource.php`, `app/Modules/Helpdesk/Filament/Resources/EmailMailboxResource.php` (+ pages), `app/Modules/Helpdesk/Filament/Resources/EmailInboundMessageResource.php` (+ pages), `app/Modules/Helpdesk/Filament/Resources/EmailOutboundMessageResource.php` (+ pages), `app/Modules/Helpdesk/Observers/TicketMessageEmailObserver.php`, `app/Providers/AppServiceProvider.php`, `routes/api.php`, `database/seeders/DemoDataSeeder.php`, `tests/Feature/EmailPipelineFeatureTest.php`, `OPENAPI.yaml`, `README.md` | `tests/Feature/EmailPipelineFeatureTest.php` (@group TKT-EMAIL-MD-02) | `GET/POST /api/email/mailboxes`, `POST /api/email/mailboxes/{mailbox}/sync`, `GET /api/email/inbound-messages`, `GET /api/email/outbound-messages`, `POST /api/email/outbound-messages/{message}/deliver` | Added IMAP ingestion + SMTP delivery services, queue observers, Filament tooling, and API/OpenAPI coverage for the email pipeline. |
| TKT-EMAIL-RB-03 (#118) | `app/Policies/EmailMailboxPolicy.php`, `app/Policies/EmailInboundMessagePolicy.php`, `app/Policies/EmailOutboundMessagePolicy.php`, `app/Providers/AuthServiceProvider.php`, `database/seeders/RoleSeeder.php`, `app/Http/Requests/StoreTicketMessageRequest.php`, `tests/Feature/EmailPipelineFeatureTest.php`, `tests/Feature/EmailPipelinePolicyTest.php`, `OPENAPI.yaml`, `README.md`, `CHANGELOG.md`, `TRACEABILITY.md` | `tests/Feature/EmailPipelineFeatureTest.php` (@group TKT-EMAIL-RB-03), `tests/Feature/EmailPipelinePolicyTest.php` (@group TKT-EMAIL-RB-03) | `GET /api/email/inbound-messages`, `GET /api/email/outbound-messages`, `POST /api/email/outbound-messages/{message}/deliver` | Hardened email pipeline RBAC with Admin/Agent/Viewer matrices, updated permissions, and documented policy-driven endpoints. |
